<form (ngSubmit)="submit()" [formGroup]="donationForm" *ngIf="campaign">
  <h1>Donating to {{ campaign.charity.name }}!</h1>
  <h2>For &quot;{{ campaign.title }}&quot;</h2>

  <div *ngIf="campaign.isMatched">
    <h3>Matched Campaign</h3>
    <p *ngIf="campaign.matchFundsRemaining > 0">
      There is currently {{ campaign.matchFundsRemaining | currency : '£' : 'symbol' : '1.0-0' }} available to match donations.
    </p>
    <p *ngIf="campaign.matchFundsRemaining == 0">
      There are currently no funds available to match donations, but please check back if you think
      these may have recently run out. Reserved match funds might become available if any donations
      are not completed successfully.
    </p>
    <h3 *ngIf="!campaign.isMatched">Regular campaign &ndash; donations are not matched</h3>
  </div>

  <!-- TODO if keeping all this detail, abstract out pieces duplicated between here and campaign-details.component -->
  <div>
    <h3>Campaign Targets</h3>
    <p *ngIf="campaign.target > 0">Campaign Target: {{ campaign.target | currency : '£' : 'symbol' : '1.0-0' }}</p>
    <p *ngIf="campaign.amountRaised > 0">Amount Raised: {{ campaign.amountRaised | currency : '£' : 'symbol' : '1.0-0' }}</p>
    <p>Donations: {{ campaign.donationCount }}</p>
  </div>

  <p *ngIf="campaign.status == 'Active'">{{ campaign.endDate | timeLeft }} left</p>

  <mat-form-field color="accent">
    <mat-label for="donationAmount">Amount (£)</mat-label>
    <input formControlName="donationAmount" id="donationAmount" matInput>
  </mat-form-field>
  <div *ngIf="f.donationAmount.invalid && (f.donationAmount.dirty || f.donationAmount.touched)" class="error">
    <div *ngIf="f.donationAmount.errors.min">Sorry, the minimum donation is currently £5.</div>
    <div *ngIf="f.donationAmount.errors.max">Sorry, the maximum single donation is £25,000.</div>
    <div *ngIf="f.donationAmount.errors.pattern">Please enter a numeric value in pounds (£) without commas.</div>
    <div *ngIf="f.donationAmount.errors.required">Please enter how much you would like to donate.</div>
  </div>

  <mat-label id="giftAid-label">Claim Gift Aid?</mat-label>
  <mat-radio-group aria-labelledby="giftAid-label" formControlName="giftAid">
      <mat-radio-button labelPosition="after" [value]="true">Yes</mat-radio-button>
      <mat-radio-button labelPosition="after" [value]="false">No</mat-radio-button>
  </mat-radio-group>

  <mat-label id="optInCharityEmail-label">Receive email from the charity?</mat-label>
  <mat-radio-group aria-labelledby="optInCharityEmail-label" formControlName="optInCharityEmail">
      <mat-radio-button labelPosition="after" [value]="true">Yes</mat-radio-button>
      <mat-radio-button labelPosition="after" [value]="false">No</mat-radio-button>
  </mat-radio-group>

  <mat-label id="optInTbgEmail-label">Receive email from the Big Give?</mat-label>
  <mat-radio-group aria-labelledby="optInTbgEmail-label" formControlName="optInTbgEmail">
      <mat-radio-button labelPosition="after" [value]="true">Yes</mat-radio-button>
      <mat-radio-button labelPosition="after" [value]="false">No</mat-radio-button>
  </mat-radio-group>

  <p *ngIf="sfApiError" class="error">
    Sorry, we can't submit your donation right now. Please try again in a moment
    or <a href="https://www.thebiggive.org.uk/s/contact-us" target="_blank">contact us</a>
    if this message persists.
  </p>

  <p *ngIf="charityCheckoutError" class="error">
    Sorry, there was an error starting your donation: "{{ charityCheckoutError }}". Please try again in a moment
    or <a href="https://www.thebiggive.org.uk/s/contact-us" target="_blank">contact us</a>
    if this message persists.
  </p>

  <p *ngIf="validationError" class="error">
    Please complete all fields above to proceed with your donation.
  </p>

  <p>
    <button mat-raised-button color="primary" type="submit" [disabled]="submitting">Donate Now</button>
  </p>
</form>

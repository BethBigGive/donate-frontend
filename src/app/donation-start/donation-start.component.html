<div class="donate-start" *ngIf="campaign" fxLayout="row" fxLayout.xs="column">
  <div>
    <div class="campaign-button">
      <button mat-icon-button class="campaign-button__button" [routerLink]="'/'">
        <mat-icon class="campaign-button__icon" aria-hidden="false" aria-label="Example home icon">keyboard_arrow_left</mat-icon>
        Back to campaign
      </button>
    </div>

    <div class="page-header">
      <p>You are donating to</p>
      <h1>{{ campaign.charity.name }}!</h1>
      <p>For the</p>
      <h2>{{ campaign.title }}</h2>
      <p>{{ campaign.summary }}</p>
    </div>

    <form (ngSubmit)="submit()" [formGroup]="donationForm" *ngIf="campaign">
      <div *ngIf="campaignIsOpen()">
        <mat-accordion multi="true">
          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Your donation</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <p><small>Enter an amount</small></p>
            <mat-form-field color="accent">
              <mat-label for="donationAmount">Amount (£)</mat-label>
              <input formControlName="donationAmount" id="donationAmount" matInput>
            </mat-form-field>
            <p><small>Or, choose</small></p>
            <button
              type="button"
              *ngFor="let suggestedAmount of suggestedAmounts"
              (click)="setAmount(suggestedAmount)"
            >{{ suggestedAmount | currency : '£' : 'symbol' : '1.0-0' }}</button>
      
            <div *ngIf="f.donationAmount.invalid && (f.donationAmount.dirty || f.donationAmount.touched)" class="error">
              <div *ngIf="f.donationAmount.errors.min">Sorry, the minimum donation is currently £5.</div>
              <div *ngIf="f.donationAmount.errors.max">Sorry, the maximum single donation is £25,000.</div>
              <div *ngIf="f.donationAmount.errors.pattern">Please enter a whole number of pounds (£) without commas or pence.</div>
              <div *ngIf="f.donationAmount.errors.required">Please enter how much you would like to donate.</div>
            </div>
          </mat-expansion-panel>

          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3 id="giftAid-label">Gift Aid</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <p><strong>Boost your donation by 25 of Gift Aid for every £1 you donate.</strong></p>
            <p><small>'I confirm that I am a UK tax payer and I understand that if I pay less income tax and/or capital gains tax in the current tax year than the amount of Gift Aid claimed on all my donations it is my responsibility to pay the difference'.</small></p>
            <p><small>Gift Aid is a government scheme for UK charities to reclaim the tax you have paid and gain 25% more at no cost or hassle to you. <a routerLink="'/terms-and-conditions'">Find out more about Gift Aid</a>.</small></p>
            <mat-radio-group aria-labelledby="giftAid-label" formControlName="giftAid">
              <mat-radio-button labelPosition="after" [value]="true"><small>Yes, I am a UK tax payer and would like Gift Aid claimed on my donations</small></mat-radio-button>
              <mat-radio-button labelPosition="after" [value]="false"><small>No, I am not a UK tax payer and do not want Gift Aid claimed on my donations</small></mat-radio-button>
            </mat-radio-group>
          </mat-expansion-panel>

          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3 id="optInCharityEmail-label">Contact</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <p><strong>Would you be happy to receive emails from {{ campaign.charity.name }}?</strong></p>
            <p><small>This may include thanks for your donation, updates on how it is being used, newsletters and future campaigns. If you select no, we will pass on your details as these may be required for Gift Aid purposes, but the charity will be informed that you do not wish to receive communications.</small></p>
            <p><small>Please note that you might continue to receive communications from {{ campaign.charity.name }} if you have already shared your details with them via other methods.</small></p>
            <mat-radio-group aria-labelledby="optInCharityEmail-label" formControlName="optInCharityEmail">
              <mat-radio-button labelPosition="after" [value]="true">Yes, I’m happy to receive emails from {{ campaign.charity.name }}</mat-radio-button>
              <mat-radio-button labelPosition="after" [value]="false">No, I would not like to receive emails from {{ campaign.charity.name }}</mat-radio-button>
            </mat-radio-group>
          </mat-expansion-panel>

          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Make your donation</h3>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <button mat-raised-button color="primary" type="submit" [disabled]="submitting">Donate £12345</button>
            <div fxLayout="row" *ngIf="campaign.isMatched">
              <div fxFlex="26">
                <p><small>Your donation</small></p>
                <p><strong>£123</strong></p>
              </div>
              <div fxFlex="11" fxLayout="row" fxLayoutAlign="center end">
                <mat-icon aria-hidden="false" aria-label="Example home icon">add</mat-icon>
              </div>
              <div fxFlex="26">
                <p><small>Matched funds</small></p>
                <p><strong>£456</strong></p>
              </div>
              <div fxFlex="11" fxLayout="row" fxLayoutAlign="center end">
                <mat-icon aria-hidden="false" aria-label="Example home icon">add</mat-icon>
              </div>
              <div fxFlex="26">
                <p><small>Gift Aid</small></p>
                <p><strong>£789</strong></p>
              </div>
            </div>
            <div fxLayout="row" *ngIf="!campaign.isMatched">
              <div fxFlex="39">
                <p><small>Your donation</small></p>
                <p><strong>£123</strong></p>
              </div>
              <div fxFlex="12" fxLayout="row" fxLayoutAlign="center end">
                <mat-icon>add</mat-icon>
              </div>
              <div fxFlex="39">
                <p><small>Gift Aid</small></p>
                <p><strong>£789</strong></p>
              </div>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-around">
              <p><small>Total amount {{ campaign.charity.name }} receive</small></p>
              <p><strong>£123.45</strong></p>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
    
        <p *ngIf="sfApiError" class="error">
          Sorry, we can't submit your donation right now. Please try again in a moment
          or <a href="https://www.thebiggive.org.uk/s/contact-us" target="_blank">contact us</a>
          if this message persists.
        </p>
    
        <p *ngIf="validationError" class="error">
          Please complete all fields above to proceed with your donation.
        </p>
    
        <mat-spinner *ngIf="submitting" color="accent" diameter="30"></mat-spinner>
    
        <p *ngIf="retrying" class="warning">
          It looks like our system is a bit busy, one moment please&hellip;
        </p>
      </div>
    </form>
  </div>

  <div>
    * * * app-campaign-details-card goes here * * *
  </div>
</div>
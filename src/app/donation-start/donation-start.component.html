<div class="donate-start" *ngIf="campaign">
  <div class="campaign-button">
    <button mat-icon-button class="campaign-button__button" [routerLink]="'/'">
      <mat-icon class="campaign-button__icon" aria-hidden="false" aria-label="Bac button">keyboard_arrow_left</mat-icon>
      Back to campaign
    </button>
  </div>

  <div fxLayout="row" fxLayout.xs="column">
    <div class="primary-column">
      <div class="page-header">
        <h3>You are donating to:</h3>
        <h1>{{ campaign.charity.name }}!</h1>
        <h3>For the:</h3>
        <h2>{{ campaign.title }}</h2>
        <p class="campaign-summary">{{ campaign.summary }}</p>
      </div>

      <form (ngSubmit)="submit()" [formGroup]="donationForm" *ngIf="campaign">
        <div *ngIf="campaignIsOpen()">
          <mat-accordion multi="true">
            <mat-expansion-panel class="your-donation" expanded="true" disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <h3>Your donation</h3>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <p class="centered-p no-margin-top"><small>Enter an amount</small></p>
              <mat-form-field color="accent">
                <mat-label for="donationAmount">Amount (£)</mat-label>
                <input formControlName="donationAmount" id="donationAmount" matInput>
              </mat-form-field>
              <p class="centered-p"><small>Or, choose</small></p>
              <div class="suggested-amount" fxLayout="row">
                <button
                fxFlex="calc((100 - 1rem)/3)"
                  class="suggested-amount__button"
                  type="button"
                  *ngFor="let suggestedAmount of suggestedAmounts"
                  (click)="setAmount(suggestedAmount)"
                >{{ suggestedAmount | currency : '£' : 'symbol' : '1.0-0' }}</button>
              </div>
        
              <div *ngIf="f.donationAmount.invalid && (f.donationAmount.dirty || f.donationAmount.touched)" class="error">
                <div *ngIf="f.donationAmount.errors.min">Sorry, the minimum donation is currently £5.</div>
                <div *ngIf="f.donationAmount.errors.max">Sorry, the maximum single donation is £25,000.</div>
                <div *ngIf="f.donationAmount.errors.pattern">Please enter a whole number of pounds (£) without commas or pence.</div>
                <div *ngIf="f.donationAmount.errors.required">Please enter how much you would like to donate.</div>
              </div>
            </mat-expansion-panel>

            <mat-expansion-panel expanded="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <h3 id="giftAid-label">Gift Aid</h3>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <p class="no-margin-top"><strong>Boost your donation by 25p of Gift Aid for every £1 you donate.</strong></p>
              <p><small>'I confirm that I am a UK tax payer and I understand that if I pay less income tax and/or capital gains tax in the current tax year than the amount of Gift Aid claimed on all my donations it is my responsibility to pay the difference'.</small></p>
              <p><small>Gift Aid is a government scheme for UK charities to reclaim the tax you have paid and gain 25% more at no cost or hassle to you. <a routerLink="'/terms-and-conditions'">Find out more about Gift Aid</a>.</small></p>
              <mat-radio-group aria-labelledby="giftAid-label" formControlName="giftAid">
                <mat-radio-button labelPosition="after" [value]="true"><small>Yes, I am a UK tax payer and would like Gift Aid claimed on my donations</small></mat-radio-button>
                <mat-radio-button labelPosition="after" [value]="false"><small>No, I am not a UK tax payer and do not want Gift Aid claimed on my donations</small></mat-radio-button>
              </mat-radio-group>
            </mat-expansion-panel>

            <mat-expansion-panel expanded="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <h3 id="optInCharityEmail-label">Contact from charity</h3>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <p class="no-margin-top"><strong>Would you be happy to receive emails from {{ campaign.charity.name }}?</strong></p>
              <p><small>This may include thanks for your donation, updates on how it is being used, newsletters and future campaigns. If you select no, we will pass on your details as these may be required for Gift Aid purposes, but the charity will be informed that you do not wish to receive communications.</small></p>
              <p><small>Please note that you might continue to receive communications from {{ campaign.charity.name }} if you have already shared your details with them via other methods.</small></p>
              <mat-radio-group aria-labelledby="optInCharityEmail-label" formControlName="optInCharityEmail">
                <mat-radio-button labelPosition="after" [value]="true"><small>Yes, I’m happy to receive emails from {{ campaign.charity.name }}</small></mat-radio-button>
                <mat-radio-button labelPosition="after" [value]="false"><small>No, I would not like to receive emails from {{ campaign.charity.name }}</small></mat-radio-button>
              </mat-radio-group>
            </mat-expansion-panel>
            
            <mat-expansion-panel expanded="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <h3 id="optInTbgEmail-label">Contact from The Big Give</h3>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <p class="no-margin-top"><strong>Would you be happy to receive emails from The Big Give?</strong></p>
              <p><small>By selecting 'no', we will no longer be able to email you about opportunities to double your donation.</small></p>
              <mat-radio-group aria-labelledby="optInTbgEmail-label" formControlName="optInTbgEmail">
                <mat-radio-button labelPosition="after" [value]="true"><small>Yes, I’m happy to receive emails from The Big Give</small></mat-radio-button>
                <mat-radio-button labelPosition="after" [value]="false"><small>No, I would not like to receive emails from The Big Give</small></mat-radio-button>
              </mat-radio-group>
            </mat-expansion-panel>

            <mat-expansion-panel class="make-your-donation" expanded="true" disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <h3>Make your donation</h3>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <button
                mat-raised-button
                type="submit"
                [disabled]="submitting"
              >Donate <strong>{{ donationForm.value.donationAmount | currency : '£' : 'symbol' : '1.0-0' }}</strong></button>
              <div class="donation-receipt" fxLayout="row" *ngIf="donationForm.value.donationAmount > 0">
                <div [fxFlex]="(expectedMatchAmount() > 0) ? 26 : 39">
                  <p class="centered-p small-p"><small>Your donation</small></p>
                  <p class="centered-p strong-p"><strong>{{ donationForm.value.donationAmount | currency : '£' : 'symbol' : '1.0-0' }}</strong></p>
                </div>
                <div fxFlex="11" fxLayout="row" fxLayoutAlign="center end">
                  <mat-icon aria-hidden="false" aria-label="Plus">add</mat-icon>
                </div>
                <div fxFlex="26" *ngIf="expectedMatchAmount() > 0">
                  <p class="centered-p small-p"><small>Matched funds</small></p>
                  <p class="centered-p strong-p"><strong>{{ expectedMatchAmount() | currency : '£' : 'symbol' : '1.0-0' }}</strong></p>
                </div>
                <div fxFlex="11" fxLayout="row" fxLayoutAlign="center end" *ngIf="expectedMatchAmount() > 0">
                  <mat-icon aria-hidden="false" aria-label="Plus">add</mat-icon>
                </div>
                <div [fxFlex]="(expectedMatchAmount() > 0) ? 26 : 39">
                  <p class="centered-p small-p"><small>Gift Aid</small></p>
                  <p class="centered-p strong-p"><strong>{{ giftAidAmount() | currency : '£' : 'symbol' : '1.2-2' }}</strong></p>
                </div>
              </div>
              <div class="receipt-total" fxLayout="row" fxLayoutAlign="space-around" *ngIf="donationForm.value.donationAmount > 0">
                <p><small>Total amount {{ campaign.charity.name }} receive:</small></p>
                <h3>{{ expectedTotalAmount() | currency : '£' : 'symbol' : '1.2-2' }}</h3>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
      
          <p *ngIf="sfApiError" class="error">
            Sorry, we can't submit your donation right now. Please try again in a moment
            or <a href="https://www.thebiggive.org.uk/s/contact-us" target="_blank">contact us</a>
            if this message persists.
          </p>
      
          <p *ngIf="validationError" class="error">
            Please complete all fields above to proceed with your donation.
          </p>
      
          <mat-spinner *ngIf="submitting" color="accent" diameter="30"></mat-spinner>
      
          <p *ngIf="retrying" class="warning">
            It looks like our system is a bit busy, one moment please&hellip;
          </p>
        </div>
      </form>
    </div>

    <div class="secondary-column">
      * * * app-campaign-details-card goes here * * *
    </div>
  </div>
</div>